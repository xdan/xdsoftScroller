/**
 * @preserve jQuery Scroller plugin v1.0.1
 * @homepage http://xdsoft.net
 * (c) 2014, Chupurnov Valeriy <chupurnov@gmail.com>.
 */
(function($){'use strict';$.fn.xdsoftScroller=function(g){return this.each(function(){var f=$(this),pointerEventToXY=function(e){var a={x:0,y:0},touch;if(e.type==='touchstart'||e.type==='touchmove'||e.type==='touchend'||e.type==='touchcancel'){touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];a.x=touch.clientX;a.y=touch.clientY}else if(e.type==='mousedown'||e.type==='mouseup'||e.type==='mousemove'||e.type==='mouseover'||e.type==='mouseout'||e.type==='mouseenter'||e.type==='mouseleave'){a.x=e.clientX;a.y=e.clientY}return a},move=0,timebox,parentHeight,height,scrollbar,scroller,maximumOffset=100,start=false,startY=0,startTop=0,h1=0,touchStart=false,startTopScroll=0,calcOffset=function(){};if(g==='hide'){f.find('.xdsoft_scrollbar').hide();return}if(!$(this).hasClass('xdsoft_scroller_box')){timebox=f.children().eq(0);parentHeight=f[0].clientHeight;height=timebox[0].offsetHeight;scrollbar=$('<div class="xdsoft_scrollbar"></div>');scroller=$('<div class="xdsoft_scroller"></div>');scrollbar.append(scroller);f.addClass('xdsoft_scroller_box').append(scrollbar);calcOffset=function calcOffset(a){var b=pointerEventToXY(a).y-startY+startTopScroll;if(b<0){b=0}if(b+scroller[0].offsetHeight>h1){b=h1-scroller[0].offsetHeight}f.trigger('scroll_element.xdsoft_scroller',[maximumOffset?b/maximumOffset:0])};scroller.on('touchstart.xdsoft_scroller mousedown.xdsoft_scroller',function(a){if(!parentHeight){f.trigger('resize_scroll.xdsoft_scroller',[g])}startY=pointerEventToXY(a).y;startTopScroll=parseInt(scroller.css('margin-top'),10);h1=scrollbar[0].offsetHeight;if(a.type==='mousedown'){if(document){$(document.body).addClass('xdsoft_noselect')}$([document.body,window]).on('mouseup.xdsoft_scroller',function arguments_callee(){$([document.body,window]).off('mouseup.xdsoft_scroller',arguments_callee).off('mousemove.xdsoft_scroller',calcOffset).removeClass('xdsoft_noselect')});$(document.body).on('mousemove.xdsoft_scroller',calcOffset)}else{touchStart=true}a.stopPropagation();a.preventDefault()}).on('touchmove',function(a){if(touchStart){a.preventDefault();calcOffset(a)}}).on('touchend touchcancel',function(a){touchStart=false;startTopScroll=0});f.on('scroll_element.xdsoft_scroller',function(a,b){if(!parentHeight){f.trigger('resize_scroll.xdsoft_scroller',[b,true])}b=b>1?1:(b<0||isNaN(b))?0:b;scroller.css('margin-top',maximumOffset*b);setTimeout(function(){timebox.css('marginTop',-parseInt((timebox[0].offsetHeight-parentHeight)*b,10))},10)}).on('resize_scroll.xdsoft_scroller',function(a,b,c){var d,sh;parentHeight=f[0].clientHeight;height=timebox[0].offsetHeight;d=parentHeight/height;sh=d*scrollbar[0].offsetHeight;if(d>=1){scroller.hide()}else{scroller.show();scroller.css('height',parseInt(sh>10?sh:10,10));maximumOffset=scrollbar[0].offsetHeight-scroller[0].offsetHeight;if(c!==true){f.trigger('scroll_element.xdsoft_scroller',[b||Math.abs(parseInt(timebox.css('marginTop'),10))/(height-parentHeight)])}}});f.on('mousewheel',function(a){var b=Math.abs(parseInt(timebox.css('marginTop'),10));b=b-(a.deltaY*20);if(b<0){b=0}f.trigger('scroll_element.xdsoft_scroller',[b/(height-parentHeight)]);a.stopPropagation();return false});f.on('touchstart',function(a){start=pointerEventToXY(a);startTop=Math.abs(parseInt(timebox.css('marginTop'),10))});f.on('touchmove',function(a){if(start){a.preventDefault();var b=pointerEventToXY(a);f.trigger('scroll_element.xdsoft_scroller',[(startTop-(b.y-start.y))/(height-parentHeight)])}});f.on('touchend touchcancel',function(a){start=false;startTop=0})}f.trigger('resize_scroll.xdsoft_scroller',[g])})}}(jQuery));